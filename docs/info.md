# Info

## Общая логика работы

`stake-helper` использует несколько ключевых компонентов для сбора, обработки и отправки данных в **INFERNO**:

1. **PSDP**  
   - Подготавливает данные перед началом сессии.  
   - Выполняет предобработку: фильтрацию, нормализацию, проверку корректности.  
   - Обеспечивает, чтобы в INFERNO попадали только согласованные и чистые данные.  

2. **Batcher (Atomic Delivery Unit)**  
   - Отправка данных выполняется не по одному событию, а пакетами (batch).  
   - Гарантирует *атомарность*: либо весь пакет доставлен целиком, либо не доставлен вовсе.  
   - Исключает частичные записи или «разрывы» в истории.  
   - Удобно для последующего анализа, так как сохраняется целостность временных рядов.  

3. **Интеграция с INFERNO**  
   - INFERNO принимает данные из разных источников.  
   - Все данные проходят через несколько каналов получения данных (Telegram, Plumber)

---

## Методы отправки данных в INFERNO

Есть несколько способов доставки информации:

- **POST-запросы к Plumber API**  
  Данные пакуются в JSON и отправляются по HTTP.  
  Этот метод используется по умолчанию, так как он:
  - простой,
  - быстрый,
  - легко логируется.

- **Telegram**  
  Вместе с отправкой пакетов посредством Plumber, данные сохраняются и в вашу Telegram-группу.  
  Настройте вашу Telegram-группу перед запуском Plumber. В противном случае логика работы приложения будет нарушена. 

---

## Запуск и рабочий процесс

1. При старте `PSDP/Batcher` инициализируется окружение (настройки, пути, ключи API, Plumber и прочее).  
2. PSDP загружает данные (из localstorage браузера).  
3. Применяются фильтры и правила валидации.  
4. Данные группируются batcher’ом.  
5. В зависимости от выбранного режима (`single`, `dual`) данные передаются в файл, которые можно будет использовать в INFERNO, согласно логике работы батчера
6. Логи работы батчера и PSDP в консоли отключены по умолчанию. 

---

## Что ещё полезно знать

- **Кэширование**  
  В некоторых случаях данные кэшируются локально (например, в `localStorage`).  
  Для отладки можно отключить кэш и работать только с «живыми» данными.

- **Режимы работы**  
  - `Live` — потоковая передача данных в INFERNO Live в реальном времени.  - В данный момент INFERNO Live находится в alfa
  - `Logs` — использование в INFERNO сохранённых файлов игры 

- **Диагностика**  
  - Проверяйте лог ошибок (по умолчанию все сообщения в консоле отключены, но вы можете раскомментировать строки, необходимые для получения информации для отладки).  
  - При атомарной доставке пакет не будет частично записан — это ожидаемое поведение. Если у вас только 1 получатель - пакеты отправляться не будут. 

- **Расширение**  
  В данный момент поддержка модульной архитектуры не реализована. Следите за обновлениями, если хотите быть в курсе последних обновлений!

---
![photo_2025-09-13_14-50-10](https://private-user-images.githubusercontent.com/68140883/493631815-6c305dd6-b0e2-4b88-9452-a96dd6675b5f.jpg?jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NTg3NjAxNTksIm5iZiI6MTc1ODc1OTg1OSwicGF0aCI6Ii82ODE0MDg4My80OTM2MzE4MTUtNmMzMDVkZDYtYjBlMi00Yjg4LTk0NTItYTk2ZGQ2Njc1YjVmLmpwZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTA5MjUlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwOTI1VDAwMjQxOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTA1YmNmOGQyODU4Y2UxYzVmMDNlOTc5MjdjZmQ3OGY5ZDFmMDU0ZDU3ZTk1ZWE4MmU4MzgxYTU3N2E5OGJjYmYmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.Yp5j1xcNVacZD0sxsJnh45lLEl0qx4GYrR9aof1SJtg)

